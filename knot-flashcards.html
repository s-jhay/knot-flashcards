<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Knot Flashcards</title>
  <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/css/bootstrap.min.css" rel="stylesheet">
  <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/js/bootstrap.bundle.min.js"></script>
  <style>
    body {
      background: #f0f0f0;
      padding: 2rem;
    }
    .flashcard {
      cursor: pointer;
      transition: transform 0.5s;
      height: auto;
      min-height: 550px;
      overflow: hidden;
      padding: 1rem;
      display: flex;
      flex-direction: column;
      justify-content: flex-start;
    }
    .card-top, .card-bottom {
      width: 100%;
      text-align: center;
    }
    .card-top {
      height: 220px;
      display: flex;
      align-items: center;
      justify-content: center;
    }
    .card-bottom {
      min-height: 280px;
      display: none;
      flex-direction: column;
      align-items: center;
      justify-content: flex-start;
      padding-top: 1rem;
    }
    .card-bottom a {
      display: block;
      margin-top: 0.5rem;
    }
    .card-content {
      width: 100%;
      height: 100%;
    }
    .card-content img {
      max-height: 200px;
      max-width: 100%;
      object-fit: contain;
      border-radius: 0.5rem;
    }
  </style>
</head>
<body>
  <div class="container text-center">
    <div class="d-grid gap-3 mx-auto mb-3" style="max-width: 400px;">
      <button class="btn btn-warning" onclick="toggleCardFrontContent()">Toggle Front Content</button>
    </div>

    <div class="card flashcard mx-auto shadow-sm" style="max-width: 400px;" onclick="flipCard()">
      <div id="cardFront" class="card-top"></div>
      <div id="cardBack" class="card-bottom"></div>
    </div>

    <div class="d-grid gap-3 mx-auto mt-4" style="max-width: 400px;">
      <div class="row g-2">
        <div class="col-6">
          <button class="btn btn-primary w-100" onclick="prevCard()">Previous</button>
        </div>
        <div class="col-6">
          <button class="btn btn-primary w-100" onclick="nextCard()">Next</button>
        </div>
      </div>
      <button class="btn btn-secondary" onclick="shuffleCards()">Shuffle</button>
    </div>
  </div>

  <script>
    let cards = [];
    fetch('cards.json')
      .then(response => response.json())
      .then(data => {
        cards = data;
        renderCard();
      });

    let currentIndex = 0;
    let flipped = false;
    let frontMode = "name";

    function getFrontElement() {
      return document.getElementById("cardFront");
    }

    function getBackElement() {
      return document.getElementById("cardBack");
    }

    function renderCard() {
      const front = getFrontElement();
      const back = getBackElement();
      const card = cards[currentIndex];

      front.innerHTML = frontMode === "name"
        ? `<h2>${card.name}</h2>`
        : `<img src="${card.image}" alt="${card.name}" class="img-fluid rounded">`;

      back.innerHTML = frontMode === "name"
        ? `<img src="${card.image}" alt="${card.name}" class="img-fluid rounded">
           <p class="mt-3">${card.description}</p>
           ${card.animationLink ? `<a href="${card.animationLink}" target="_blank" rel="noopener noreferrer">View animation</a>` : ''}
           ${card.videoLink ? `<a href="${card.videoLink}" target="_blank" rel="noopener noreferrer">Watch video</a>` : ''}`
        : `<h2>${card.name}</h2>
           <p class="mt-3">${card.description}</p>
           ${card.animationLink ? `<a href="${card.animationLink}" target="_blank" rel="noopener noreferrer">View animation</a>` : ''}
           ${card.videoLink ? `<a href="${card.videoLink}" target="_blank" rel="noopener noreferrer">Watch video</a>` : ''}`;

      resetFlip();
    }

    function flipCard() {
      const front = getFrontElement();
      const back = getBackElement();
      if (flipped) {
        front.style.display = "flex";
        back.style.display = "none";
      } else {
        front.style.display = "none";
        back.style.display = "flex";
      }
      flipped = !flipped;
    }

    function resetFlip() {
      const front = getFrontElement();
      const back = getBackElement();
      flipped = false;
      front.style.display = "flex";
      back.style.display = "none";
    }

    function toggleCardFrontContent() {
      frontMode = frontMode === "name" ? "image" : "name";
      renderCard();
    }

    function nextCard() {
      currentIndex = (currentIndex + 1) % cards.length;
      renderCard();
    }

    function prevCard() {
      currentIndex = (currentIndex - 1 + cards.length) % cards.length;
      renderCard();
    }

    function shuffleCards() {
      const currentCard = cards[currentIndex];
      for (let i = cards.length - 1; i > 0; i--) {
        const j = Math.floor(Math.random() * (i + 1));
        [cards[i], cards[j]] = [cards[j], cards[i]];
      }
      if (cards[0].name === currentCard.name && cards.length > 1) {
        [cards[0], cards[1]] = [cards[1], cards[0]];
      }
      currentIndex = 0;
      renderCard();
    }
  </script>
</body>
</html>
